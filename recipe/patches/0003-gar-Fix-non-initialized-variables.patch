From 7457988083c7e44bef4d72f00fd395c5e578e5ea Mon Sep 17 00:00:00 2001
From: Joris Vaillant <joris.vaillant@inria.fr>
Date: Mon, 22 Jul 2024 13:52:36 +0200
Subject: [PATCH 1/2] gar: Fix non initialized variables

---
 gar/include/aligator/gar/blk-matrix.hpp    | 6 ++++++
 gar/include/aligator/gar/dense-riccati.hpp | 6 +++---
 2 files changed, 9 insertions(+), 3 deletions(-)

diff --git a/gar/include/aligator/gar/blk-matrix.hpp b/gar/include/aligator/gar/blk-matrix.hpp
index 91494cf7..2c57052b 100644
--- a/gar/include/aligator/gar/blk-matrix.hpp
+++ b/gar/include/aligator/gar/blk-matrix.hpp
@@ -123,6 +123,12 @@ public:
   }
 
   void setZero() { m_data.setZero(); }
+  static BlkMatrix Zero(const row_dim_t &rowDims, const col_dim_t &colDims) {
+
+    BlkMatrix out(rowDims, colDims);
+    out.setZero();
+    return out;
+  }
 
   template <typename Other> inline void swap(BlkMatrix<Other, N, M> &other) {
     m_data.swap(other.matrix());
diff --git a/gar/include/aligator/gar/dense-riccati.hpp b/gar/include/aligator/gar/dense-riccati.hpp
index 5223d3d3..d8fc2c8f 100644
--- a/gar/include/aligator/gar/dense-riccati.hpp
+++ b/gar/include/aligator/gar/dense-riccati.hpp
@@ -34,9 +34,9 @@ public:
     using ldl_t = decltype(FactorData::ldl);
     long ntot = std::accumulate(dims.begin(), dims.end(), 0);
     uint nth = knot.nth;
-    return FactorData{BlkMat44(dims, dims), BlkVec4(dims, {1}),
-                      BlkRowMat41(dims, {knot.nx}), BlkRowMat41(dims, {nth}),
-                      ldl_t{ntot}};
+    return FactorData{BlkMat44::Zero(dims, dims), BlkVec4::Zero(dims, {1}),
+                      BlkRowMat41::Zero(dims, {knot.nx}),
+                      BlkRowMat41::Zero(dims, {nth}), ldl_t{ntot}};
   }
 
   std::vector<FactorData> datas;
-- 
2.34.1

